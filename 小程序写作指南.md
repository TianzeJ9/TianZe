# 一些常见代码

## 1.常用注释

```js
console.log("失败"); 控制台输出 类似于println
//单行json注释
/*js的注释*/

<!--wxml的单行注释-->
/*wxml的多行注释*/

/* wxss的注释 */    

//单行json注释
/* 多行json注释*/
    
success(res)等方法里的参数的导入都是为了方法里用该参数的一些方法导入的.
```

## 1.5 相关注解

```java
注解@RequestParam接收的参数是来自requestHeader中，即请求头。通常用于GET请求，像POST、DELETE等其它类型的请求也可以使用。

注解@RequestBody接收的参数是来自requestBody中，即请求体。一般用于处理非 Content-Type: application/x-www-form-urlencoded编码格式的数据，比如：application/json、application/xml等类型的数据。通常用于接收POST、DELETE等类型的请求数据，GET类型也可以适用
```



## 2.常用定义变量

```js
三种声明变量的方式：var、let、const。 

var：声明全局变量

let：声明块级变量，即局部变量。

const：用于声明常量，也具有块级作用域 const PI=3.14;
```

## 3.js文件

```js
//先定义变量类如let a,b,c
//然后js以Page为主操作开始结束.
Page({
})
```

## 4.小程序如何运行

```java
/* wxml定义格式,界面展示,里面可以定义按钮和数据之类的 和js一同展示出界面
然后js里从网页上获得的数据经过渲染(用变量 wxml里也定义{{}}一个值)传到wxml里

json里放的是json数据也可以直接被wxml获取.json里面也可以调整一个页面的单独文字大小,背景色等等.

wxss是调整手机显示,左右宽等等之类的.
```

## 5.开始写

```java
/* 创建的每个文件夹都需要包括.js ,json ,wxml .wxss
创建完之后需要在app.json里把这个注入进去 pages/文件名/文件名
```

## 6.let that=this

```java
/*    微信小程序开发过程中发现一个很奇怪的问题，有些情况下用 this.setData 可以改变初始化数据data，有些情况下使用this.setData无效，比如：在wx.request({});方法调用成功或者失败之后，有时候需要使用this.setData修改初始化数据data，更新视图数据。需要使用 let that = this; that.setData({ xx }); 使用 that 来保存当前的this状态，更新视图数据。

原因分析：微信小程序中，在wx.request({});方法调用成功或者失败之后，当使用this.setData修改初始化数据data时，如果使用this.data来获取，会出现获取不到的情况，调试页面也会报undefiend。在javascript中，this代表着当前对象，会随着程序的执行过程中的上下文改变，在wx.request({});方法的回调函数中，对象已经发生改变，this已经不是wx.request({});方法对象了，data属性也不存在了，从而无法实现对data数据的修改。

```

# 示例的前后端交互代码

## 1.查询按钮



```js
//bing.js里 getall方法

  getall(){
    let that=this
    wx.request({
      //请求的路径
      url: 'http://localhost:8081/hmyx/product/list',
      //请求的方式
      method:"get",
      // 查询数据用返回的数据格式为json格式 application/json
       //一般提交数据用application/x-www-form-urlencoded
      header:{
        "content-type":"application/json"
      },
      //接口调用成功的回调函数
      success(res){
        //控制台打印查询成功 打印res信息 包括请求头 statusCode
        //data数据类型 data里的数据 proto等
        console.log("查询成功",res)
        //如果res状态码为200代表表示请求已成功
        if(res.statusCode==200){
          //更新数据 datalist在wxml里 赋值进去
          that.setData({datalist:res.data})
        }
        else{
          //跳出一个显示消息提示框 
          wx.showToast({
            //icon没有图表
            icon:"none",
            //信息为查询失败
            title: '查询失败',
            
          })
          //更新数据
          that.setData({datalist:res.data})
        }
      },
      //接口调用失败的话 控制台打印查询失败和res信息
      fail(res){
        console.log("查询失败",res)
      },
})}
```

```wxml
/* bing.wxml中对应的 */
//点击查按钮 执行getall方法
<button bindtap="getall">查</button>
//循环获得datalist数据
<block wx:for="{{datalist}}" wx:key="index">
//将datalist中的brandid显示出来 item.brandId brandId就是网页上的brandId后面的内容
  <view>{{item.brandId}}</view>
</block>
```

## 2.插入一条数据

```java
   @Autowired
    private UserMapper usermapper;

    @GetMapping("/add")
//RequestParam是把从小程序端接收到的数据传递到这里面的参数变量中
/*value 是参数名字 required 是 是否这个必须有值 defaultvalue是从
小程序中获取的需要传递的数据的变量名
注解@RequestParam接收的参数是来自requestHeader中，即请求头。通常用于GET请求，像POST、DELETE等其它类型的请求也可以使用。

注解@RequestBody接收的参数是来自requestBody中，即请求体。一般用于处理非 Content-Type: application/x-www-form-urlencoded编码格式的数据，比如：application/json、application/xml等类型的数据。通常用于接收POST、DELETE等类型的请求数据，GET类型也可以适用*/
    public int add(@RequestParam(value="name",required=true,defaultValue = "name")String name,
                   @RequestParam(value="age",required=true,defaultValue = "age")String age,
                   @RequestParam(value="gender",required=true,defaultValue = "gender")String gender)
    {
        System.out.println("添加成功");
        return usermapper.insert(new User(name,age,gender));
    }
```

```js
add(){
    console.log(brandId,name,age,gender)
    let that=this
    wx.request({
      url: 'http://localhost:8081/hmyx/user/add',
      method:"get",
      header:{
        "content-type":"application/x-www-form-urlencoded"
      },
      data:{
        brandId:brandId,
        name:name,
        age:age,
        gender:gender
      },
      success(res){
        console.log("成功",res)
        that.setData({result:res.data})
        if(res.statusCode==200){
          wx.showToast({
            title: '添加成功'
          })
          }else{
            wx.showToast({
              icon:"none",
              title: '添加失败',
            })
          }
        },
     
      fail(res){
        console.log("失败",res)
      }
    })
```

